<div class="container">
    <!-- Sidebar Menu -->
    <div class="sidebar" (mouseover)="openMenu()" (mouseleave)="closeMenu()" [class.expanded]="isMenu">
        <!-- Logo -->
        <div class="logo" *ngIf="isMenu">
          METRONIC
          <span class="collapse-icon">¬´</span>
        </div>
        <div class="menu" *ngIf="isMenu" style="color: #fff;">
          <h6>CH·ª®C NƒÇNG</h6>
        </div>
        <ul>
          <li class="has-dropdown">
            <details *ngIf="isMenu">
              <summary >ChƒÉm s√≥c kh√°ch h√†ng</summary>
              <ul class="drop-menu" >
                <li><a routerLink="/admin/contact">Qu·∫£n l√Ω y√™u c·∫ßu</a></li>
                <li><a routerLink="/admin/customer">Qu·∫£n l√Ω ng∆∞·ªùi d√πng</a></li>
              </ul>
            </details>
          </li>
          <li class="has-dropdown" *ngIf="isAdmin">
            <details *ngIf="isMenu">
              <summary >Qu·∫£n l√Ω ƒë∆°n h√†ng</summary>
              <ul class="drop-menu" >
                <li><a routerLink="/admin/orderprocessing">Qu·∫£n l√Ω ƒë∆°n h√†ng ƒë∆∞·ª£c duy·ªát</a></li>
                <li><a routerLink="/admin/order">Qu·∫£n l√Ω ƒë∆°n h√†ng</a></li>
              </ul>
            </details>
          </li>
          <li class="has-dropdown">
            <details *ngIf="isMenu">
              <summary >S·∫£n Ph·∫©m</summary>
              <ul class="drop-menu" >
                <li><a routerLink="/admin/product">Qu·∫£n l√Ω s·∫£n ph·∫©m</a></li>
                <li><a routerLink="/admin/category">Qu·∫£n l√Ω danh m·ª•c</a></li>
                <li><a routerLink="/admin/image">Qu·∫£n l√Ω h√¨nh ·∫£nh</a></li>
              </ul>
            </details>
          </li>
          <li class="has-dropdown" *ngIf="isAdmin">
            <details *ngIf="isMenu">
              <summary >B·ªô s∆∞u t·∫≠p </summary>
              <ul class="drop-menu" >
                <li><a routerLink="/admin/blog">Danh s√°ch Blog</a></li>
              </ul>
            </details>
          </li>
          <li class="has-dropdown" *ngIf="isAdmin">
            <details *ngIf="isMenu">
              <summary >B√¨nh lu·∫≠n</summary>
              <ul class="drop-menu" >
                <li><a routerLink="/admin/comment">Danh s√°ch b√¨nh lu·∫≠n</a></li>
              </ul>
            </details>
          </li>
          <li class="has-dropdown" *ngIf="isAdmin">
            <details *ngIf="isMenu">
              <summary >Ph√¢n quy·ªÅn </summary>
              <ul class="drop-menu" >
                <li><a routerLink="/admin/user">Nh√¢n s·ª±</a></li>
                <li><a routerLink="/admin/nhomquyen">Nh√≥m quy·ªÅn</a></li>
                <li><a routerLink="/admin/role">Quy·ªÅn</a></li>
              </ul>
            </details>
          </li>
          <li class="has-dropdown">
            <details *ngIf="isMenu">
              <summary >G·ª≠i th√¥ng b√°o t·ª± ƒë·ªông </summary>
              <ul class="drop-menu" >
                <li><a routerLink="">Th√¥ng b√°o t·ª± ƒë·ªông</a></li>
              </ul>
            </details>
          </li>
          <li class="has-dropdown">
            <details *ngIf="isMenu">
              <summary >L·ªãch s·ª≠</summary>
              <ul class="drop-menu" >
                <li><a routerLink="/admin/history">Th√¥ng tin l·ªãch s·ª≠ h·ªá th·ªëng</a></li>
              </ul>
            </details>
          </li>
          <li *ngIf="isMenu"><button class="update-btn" (click)="logout()">ƒêƒÉng xu·∫•t</button></li>
        </ul>
    </div>

    <!--main-->
    <div class="permission-main">
        <!-- Ti√™u ƒë·ªÅ v√† n√∫t -->
        <div class="header">
            <div class="header-content">
                <h2>Qu·∫£n l√Ω quy·ªÅn h·∫°n <span routerLink="/admin/home" class="sub-header">Trang ch·ªß</span></h2>
            </div>
        </div>
        <button class="update-btn" (click)="toggleAddForm()">Th√™m nh√≥m quy·ªÅn</button>
        <!-- Form Th√™m Quy·ªÅn H·∫°n -->
        <div class="add-permission-section" *ngIf="showAddForm">
            <div class="overlay" (click)="resetForm()"></div>
            <div class="add-permission-content">
                <div class="modal-header">
                    <h3>Th√™m Quy·ªÅn H·∫°n</h3>
                    <button class="close-btn" (click)="closeAddForm()">√ó</button>
                </div>
                <form (ngSubmit)="addPermission()" class="permission-form">
                    <div class="form-group">
                        <label for="permissionName" class="bold">T√™n Quy·ªÅn H·∫°n:</label>
                        <input id="permissionName" type="text" [(ngModel)]="newPermission.Name" name="permissionName"
                            class="form-control" required />
                    </div>
                    <div class="form-group">
                        <label class="bold">Ch·ªçn Vai Tr√≤:</label>
                        <div class="role-selection">
                            <div *ngFor="let role of roles" class="role-option">
                                <input type="checkbox" [id]="'role-' + role.Id" [value]="role.Id"
                                    (change)="toggleRoleSelection(role.Id)"
                                    [checked]="selectedRoles.includes(role.Id)" />
                                <label [for]="'role-' + role.Id">{{ role.Name }}</label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="cancel-btn" (click)="closeAddForm()">H·ªßy</button>
                        <button type="submit" class="submit-btn" [disabled]="!newPermission.Name">Th√™m</button>
                    </div>
                </form>
            </div>
        </div>
        <!-- Form Ch·ªânh S·ª≠a Quy·ªÅn H·∫°n -->
        <div class="edit-permission-section" *ngIf="editPermission">
            <div class="overlay" (click)="closedit()"></div>
            <div class="edit-permission-content">
                <div class="modal-header">
                    <h3>Ch·ªânh S·ª≠a Quy·ªÅn H·∫°n</h3>
                    <button class="close-btn" (click)="closedit()">√ó</button>
                </div>
                <form (ngSubmit)="updatePermission()" class="permission-form">
                    <div class="form-group">
                        <label for="editPermissionName" class="bold">T√™n Quy·ªÅn H·∫°n:</label>
                        <input id="editPermissionName" type="text" [(ngModel)]="editPermission.Name"
                            name="editPermissionName" class="form-control" required />
                    </div>
                    <div class="form-group">
                        <label class="bold">Ch·ªçn Vai Tr√≤:</label>
                        <div class="role-selection">
                            <div *ngFor="let role of roles" class="role-option">
                                <input type="checkbox" [id]="'edit-role-' + role.Id" [value]="role.Id"
                                    (change)="toggleRoleSelection(role.Id)"
                                    [checked]="selectedRoles.includes(role.Id)" />
                                <label [for]="'edit-role-' + role.Id">{{ role.Name }}</label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="cancel-btn" (click)="closedit()">H·ªßy</button>
                        <button type="submit" class="submit-btn">L∆∞u</button>
                    </div>
                </form>
            </div>
        </div>
        <!-- B·∫£ng danh s√°ch quy·ªÅn h·∫°n -->
        <table class="table table-bordered">
            <thead>
                <tr style="text-align: center;" >
                    <th>ID</th>
                    <th>T√™n</th>
                    <th>Vai Tr√≤</th>
                    <th>H√†nh ƒë·ªông</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let permission of permissions">
                    <td>{{ permission.Id }}</td>
                    <td>{{ permission.Name }}</td>
                    <td>
                        <ul>
                            <li *ngFor="let role of permission.PermissionRoles">{{ role.RoleName }}</li>
                        </ul>
                    </td>
                    <td style="text-align: center;">
                        <button class="btn btn-warning btn-sm" (click)="edit(permission)" >‚úèÔ∏è S·ª≠a</button>
                        <button style="margin-left: 20px;" class="btn btn-danger btn-sm" (click)="deletePermission(permission.Id)">üíæ X√≥a</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>